api-version: reviewpad.com/v3.x

mode: silent

workflows:
  - name: label-pull-request-with-size
    always-run: true
    if:
      - rule: $size() <= 10
        extra-actions:
          - $addLabel("small")
      - rule: $size() > 10 && $size() <= 100
        extra-actions:
          - $addLabel("medium")
      - rule: $size() > 100
        extra-actions:
          - $addLabel("large")

  - name: empty-description
    on:
      - "issue"
      - "pull_request"
    always-run: true
    if:
      - $description() == ""
    then: 
      - '$error("The description is empty. Please add more information!")'

  # - name: go-live-process
  #   always-run: true
  #   if:
  #     - '$moved("@1/qa/@2", "@1/prod/@2")'
  #   then:
  #     - '$addLabel("LGTM")'
  #     - '$merge()'

  - name: critical-code
    always-run: true
    if:
      - '$hasAnnotation("critical")'
    then:
      - '$info("This pull request changes critical code")'

  - name: changes-to-file
    always-run: true
    if:
      - '!$changed("go/@1.go", "go/@1_test.go")'
    then:
      - '$info("forgot to change tests")'